#!/bin/bash

docker run -v /home/putty_final/grib:/grib2 --tmpfs /grib area51/wgrib2:latest /bin/sh -c "wget -O /grib/fcst.grib 'https://nomads.ncep.noaa.gov/cgi-bin/filter_hrrr_2d.pl?file=hrrr.t00z.wrfsfcf00.grib2&lev_10_m_above_ground=on&lev_2_m_above_ground=on&lev_surface=on&var_APCP=on&var_CFRZR=on&var_CICEP=on&var_CRAIN=on&var_CSNOW=on&var_DPT=on&var_GUST=on&var_PRATE=on&var_PRES=on&var_RH=on&var_TMP=on&var_UGRD=on&var_VGRD=on&var_VIS=on&leftlon=0&rightlon=360&toplat=90&bottomlat=-90&dir=%2Fhrrr.20200731%2Fconus'; wgrib2 /grib/fcst.grib -match ':CFRZR:' -csv /grib/fcstCFRZR00.csv; (awk -F',' '{print \$5\",\"\$6\",\"\$7}' /grib/fcstCFRZR00.csv)>/grib/outCFRZR00.csv; rm -rf /grib/fcstCFRZR00.csv; wgrib2 /grib/fcst.grib -match ':CRAIN:' -csv /grib/fcstCRAIN00.csv; (awk -F',' '{print \$7}' /grib/fcstCRAIN00.csv)>/grib/outCRAIN00.csv; rm -rf /grib/fcstCRAIN00.csv; wgrib2 /grib/fcst.grib -match ':VIS:' -csv /grib/fcstVIS00.csv; (awk -F',' '{print \$7}' /grib/fcstVIS00.csv)>/grib/outVIS00.csv; rm -rf /grib/fcstVIS00.csv; wgrib2 /grib/fcst.grib -match ':CSNOW:' -csv /grib/fcstCSNOW00.csv; (awk -F',' '{print \$7}' /grib/fcstCSNOW00.csv)>/grib/outCSNOW00.csv; rm -rf /grib/fcstCSNOW00.csv; wgrib2 /grib/fcst.grib -match ':PRATE:' -csv /grib/fcstPRATE00.csv; (awk -F',' '{print \$7}' /grib/fcstPRATE00.csv)>/grib/outPRATE00.csv; rm -rf /grib/fcstPRATE00.csv; wgrib2 /grib/fcst.grib -match ':TMP:2 m above ground:' -csv /grib/fcstTMP00.csv; (awk -F',' '{print \$7}' /grib/fcstTMP00.csv)>/grib/outTMP00.csv; rm -rf /grib/fcstTMP00.csv; wgrib2 /grib/fcst.grib -match ':UGRD:10 m above ground:anl:' -csv /grib/fcstUGRD00.csv; (awk -F',' '{print \$7}' /grib/fcstUGRD00.csv)>/grib/outUGRD00.csv; rm -rf /grib/fcstUGRD00; wgrib2 /grib/fcst.grib -match ':VGRD:10 m above ground:anl:' -csv /grib/fcstVGRD00.csv; (awk -F',' '{print \$7}' /grib/fcstVGRD00.csv)>/grib/outVGRD00.csv; rm -rf /grib/fcstVGRD00; wgrib2 /grib/fcst.grib -match ':PRES:' -csv /grib/fcstPRES00.csv; (awk -F',' '{print \$7}' /grib/fcstPRES00.csv)>/grib/outPRES00.csv; rm -rf /grib/fcstPRES00.csv; wgrib2 /grib/fcst.grib -match ':APCP:' -csv /grib/fcstAPCP00.csv; (awk -F',' '{print \$7}' /grib/fcstAPCP00.csv)>/grib/outAPCP00.csv; rm -rf /grib/fcstAPCP00.csv; wgrib2 /grib/fcst.grib -match ':CICEP:' -csv /grib/fcstCICEP00.csv; (awk -F',' '{print \$7}' /grib/fcstCICEP00.csv)>/grib/outCICEP00.csv; rm -rf /grib/fcstCICEP00.csv; wgrib2 /grib/fcst.grib -match ':DPT:' -csv /grib/fcstDPT00.csv; (awk -F',' '{print \$7}' /grib/fcstDPT00.csv)>/grib/outDPT00.csv; rm -rf /grib/fcstDPT00; wgrib2 /grib/fcst.grib -match ':GUST:' -csv /grib/fcstGUST00.csv; (awk -F',' '{print \$7}' /grib/fcstGUST00.csv)>/grib/outGUST00.csv; rm -rf /grib/fcstGUST00.csv; wgrib2 /grib/fcst.grib -match ':RH:' -csv /grib/fcstRH00.csv; (awk -F',' '{print \$7}' /grib/fcstRH00.csv)>/grib/outRH00.csv; rm -rf /grib/fcstRH00.csv; paste -d ',' /grib/outCFRZR00.csv /grib/outCRAIN00.csv /grib/outVIS00.csv /grib/outCSNOW00.csv /grib/outPRATE00.csv /grib/outTMP00.csv /grib/outUGRD00.csv /grib/outVGRD00.csv /grib/outPRES00.csv /grib/outAPCP00.csv /grib/outCICEP00.csv /grib/outDPT00.csv /grib/outGUST00.csv /grib/outRH00.csv> /grib2/merged_hrrr00.csv"


for fHour in {1..2..1}
do
hFormat=$(printf "%02d" $fHour)
hFormatNow=$(printf "%d" $fHour)
hFormatOld=$(printf "%d" $(($fHour - 1)))

docker run -v /home/putty_final/grib:/grib2 --tmpfs /grib area51/wgrib2:latest /bin/sh -c "wget -O /grib/fcst.grib 'https://nomads.ncep.noaa.gov/cgi-bin/filter_hrrr_2d.pl?file=hrrr.t00z.wrfsfcf$hFormat.grib2&lev_10_m_above_ground=on&lev_2_m_above_ground=on&lev_surface=on&var_APCP=on&var_CFRZR=on&var_CICEP=on&var_CRAIN=on&var_CSNOW=on&var_DPT=on&var_GUST=on&var_PRATE=on&var_PRES=on&var_RH=on&var_TMP=on&var_UGRD=on&var_VGRD=on&var_VIS=on&leftlon=0&rightlon=360&toplat=90&bottomlat=-90&dir=%2Fhrrr.20200731%2Fconus'; wgrib2 /grib/fcst.grib -match ':CFRZR:' -csv /grib/fcstCFRZR00.csv; (awk -F',' '{print \$7}' /grib/fcstCFRZR00.csv)>/grib/outCFRZR00.csv; rm -rf /grib/fcstCFRZR00.csv; wgrib2 /grib/fcst.grib -match ':CRAIN:' -csv /grib/fcstCRAIN00.csv; (awk -F',' '{print \$7}' /grib/fcstCRAIN00.csv)>/grib/outCRAIN00.csv; rm -rf /grib/fcstCRAIN00.csv; wgrib2 /grib/fcst.grib -match ':VIS:' -csv /grib/fcstVIS00.csv; (awk -F',' '{print \$7}' /grib/fcstVIS00.csv)>/grib/outVIS00.csv; rm -rf /grib/fcstVIS00.csv; wgrib2 /grib/fcst.grib -match ':CSNOW:' -csv /grib/fcstCSNOW00.csv; (awk -F',' '{print \$7}' /grib/fcstCSNOW00.csv)>/grib/outCSNOW00.csv; rm -rf /grib/fcstCSNOW00.csv; wgrib2 /grib/fcst.grib -match ':PRATE:' -csv /grib/fcstPRATE00.csv; (awk -F',' '{print \$7}' /grib/fcstPRATE00.csv)>/grib/outPRATE00.csv; rm -rf /grib/fcstPRATE00.csv; wgrib2 /grib/fcst.grib -match ':TMP:2 m above ground:' -csv /grib/fcstTMP00.csv; (awk -F',' '{print \$7}' /grib/fcstTMP00.csv)>/grib/outTMP00.csv; rm -rf /grib/fcstTMP00.csv; wgrib2 /grib/fcst.grib -match ':UGRD:10 m above ground:' -csv /grib/fcstUGRD00.csv; (awk -F',' '{print \$7}' /grib/fcstUGRD00.csv)>/grib/outUGRD00.csv; rm -rf /grib/fcstUGRD00; wgrib2 /grib/fcst.grib -match ':VGRD:10 m above ground:' -csv /grib/fcstVGRD00.csv; (awk -F',' '{print \$7}' /grib/fcstVGRD00.csv)>/grib/outVGRD00.csv; rm -rf /grib/fcstVGRD00; wgrib2 /grib/fcst.grib -match ':PRES:' -csv /grib/fcstPRES00.csv; (awk -F',' '{print \$7}' /grib/fcstPRES00.csv)>/grib/outPRES00.csv; rm -rf /grib/fcstPRES00.csv; wgrib2 /grib/fcst.grib -match ':APCP:surface:$hFormatOld-$hFormatNow' -csv /grib/fcstAPCP00.csv; (awk -F',' '{print \$7}' /grib/fcstAPCP00.csv)>/grib/outAPCP00.csv; rm -rf /grib/fcstAPCP00.csv; wgrib2 /grib/fcst.grib -match ':CICEP:' -csv /grib/fcstCICEP00.csv; (awk -F',' '{print \$7}' /grib/fcstCICEP00.csv)>/grib/outCICEP00.csv; rm -rf /grib/fcstCICEP00.csv; wgrib2 /grib/fcst.grib -match ':DPT:' -csv /grib/fcstDPT00.csv; (awk -F',' '{print \$7}' /grib/fcstDPT00.csv)>/grib/outDPT00.csv; rm -rf /grib/fcstDPT00; wgrib2 /grib/fcst.grib -match ':GUST:' -csv /grib/fcstGUST00.csv; (awk -F',' '{print \$7}' /grib/fcstGUST00.csv)>/grib/outGUST00.csv; rm -rf /grib/fcstGUST00.csv; wgrib2 /grib/fcst.grib -match ':RH:' -csv /grib/fcstRH00.csv; (awk -F',' '{print \$7}' /grib/fcstRH00.csv)>/grib/outRH00.csv; rm -rf /grib/fcstRH00.csv; paste -d ',' /grib/outCFRZR00.csv /grib/outCRAIN00.csv /grib/outVIS00.csv /grib/outCSNOW00.csv /grib/outPRATE00.csv /grib/outTMP00.csv /grib/outUGRD00.csv /grib/outVGRD00.csv /grib/outPRES00.csv /grib/outAPCP00.csv /grib/outCICEP00.csv /grib/outDPT00.csv /grib/outGUST00.csv /grib/outRH00.csv> /grib2/merged_hrrr$hFormat.csv"

done


paste -d',' /home/putty_final/grib/merged_hrrr* >/home/putty_final/hrrrM.csv
 
 
toolbox
bq load  --replace --source_format=CSV brightground:hrrr.dataIN /media/root/home/putty_final/hrrrM.csv lon:NUMERIC,lat:NUMERIC,CFRZR_0:FLOAT,CRAIN_0:FLOAT,VIS_0:FLOAT,CSNOW_0:FLOAT,PRATE_0:FLOAT,TMP_0:FLOAT,UGRD_0:FLOAT,VGRD_0:FLOAT,PRES_0:FLOAT,APCP_0:FLOAT,CICEP_0:FLOAT,DPT_0:FLOAT,GUST_0:FLOAT,RH_0:FLOAT,CFRZR_1:FLOAT,CRAIN_1:FLOAT,VIS_1:FLOAT,CSNOW_1:FLOAT,PRATE_1:FLOAT,TMP_1:FLOAT,UGRD_1:FLOAT,VGRD_1:FLOAT,PRES_1:FLOAT,APCP_1:FLOAT,CICEP_1:FLOAT,DPT_1:FLOAT,GUST_1:FLOAT,RH_1:FLOAT,CFRZR_2:FLOAT,CRAIN_2:FLOAT,VIS_2:FLOAT,CSNOW_2:FLOAT,PRATE_2:FLOAT,TMP_2:FLOAT,UGRD_2:FLOAT,VGRD_2:FLOAT,PRES_2:FLOAT,APCP_2:FLOAT,CICEP_2:FLOAT,DPT_2:FLOAT,GUST_2:FLOAT,RH_2:FLOAT,CFRZR_3:FLOAT,CRAIN_3:FLOAT,VIS_3:FLOAT,CSNOW_3:FLOAT,PRATE_3:FLOAT,TMP_3:FLOAT,UGRD_3:FLOAT,VGRD_3:FLOAT,PRES_3:FLOAT,APCP_3:FLOAT,CICEP_3:FLOAT,DPT_3:FLOAT,GUST_3:FLOAT,RH_3:FLOAT,CFRZR_4:FLOAT,CRAIN_4:FLOAT,VIS_4:FLOAT,CSNOW_4:FLOAT,PRATE_4:FLOAT,TMP_4:FLOAT,UGRD_4:FLOAT,VGRD_4:FLOAT,PRES_4:FLOAT,APCP_4:FLOAT,CICEP_4:FLOAT,DPT_4:FLOAT,GUST_4:FLOAT,RH_4:FLOAT,CFRZR_5:FLOAT,CRAIN_5:FLOAT,VIS_5:FLOAT,CSNOW_5:FLOAT,PRATE_5:FLOAT,TMP_5:FLOAT,UGRD_5:FLOAT,VGRD_5:FLOAT,PRES_5:FLOAT,APCP_5:FLOAT,CICEP_5:FLOAT,DPT_5:FLOAT,GUST_5:FLOAT,RH_5:FLOAT,CFRZR_6:FLOAT,CRAIN_6:FLOAT,VIS_6:FLOAT,CSNOW_6:FLOAT,PRATE_6:FLOAT,TMP_6:FLOAT,UGRD_6:FLOAT,VGRD_6:FLOAT,PRES_6:FLOAT,APCP_6:FLOAT,CICEP_6:FLOAT,DPT_6:FLOAT,GUST_6:FLOAT,RH_6:FLOAT,CFRZR_7:FLOAT,CRAIN_7:FLOAT,VIS_7:FLOAT,CSNOW_7:FLOAT,PRATE_7:FLOAT,TMP_7:FLOAT,UGRD_7:FLOAT,VGRD_7:FLOAT,PRES_7:FLOAT,APCP_7:FLOAT,CICEP_7:FLOAT,DPT_7:FLOAT,GUST_7:FLOAT,RH_7:FLOAT,CFRZR_8:FLOAT,CRAIN_8:FLOAT,VIS_8:FLOAT,CSNOW_8:FLOAT,PRATE_8:FLOAT,TMP_8:FLOAT,UGRD_8:FLOAT,VGRD_8:FLOAT,PRES_8:FLOAT,APCP_8:FLOAT,CICEP_8:FLOAT,DPT_8:FLOAT,GUST_8:FLOAT,RH_8:FLOAT,CFRZR_9:FLOAT,CRAIN_9:FLOAT,VIS_9:FLOAT,CSNOW_9:FLOAT,PRATE_9:FLOAT,TMP_9:FLOAT,UGRD_9:FLOAT,VGRD_9:FLOAT,PRES_9:FLOAT,APCP_9:FLOAT,CICEP_9:FLOAT,DPT_9:FLOAT,GUST_9:FLOAT,RH_9:FLOAT,CFRZR_10:FLOAT,CRAIN_10:FLOAT,VIS_10:FLOAT,CSNOW_10:FLOAT,PRATE_10:FLOAT,TMP_10:FLOAT,UGRD_10:FLOAT,VGRD_10:FLOAT,PRES_10:FLOAT,APCP_10:FLOAT,CICEP_10:FLOAT,DPT_10:FLOAT,GUST_10:FLOAT,RH_10:FLOAT,CFRZR_11:FLOAT,CRAIN_11:FLOAT,VIS_11:FLOAT,CSNOW_11:FLOAT,PRATE_11:FLOAT,TMP_11:FLOAT,UGRD_11:FLOAT,VGRD_11:FLOAT,PRES_11:FLOAT,APCP_11:FLOAT,CICEP_11:FLOAT,DPT_11:FLOAT,GUST_11:FLOAT,RH_11:FLOAT,CFRZR_12:FLOAT,CRAIN_12:FLOAT,VIS_12:FLOAT,CSNOW_12:FLOAT,PRATE_12:FLOAT,TMP_12:FLOAT,UGRD_12:FLOAT,VGRD_12:FLOAT,PRES_12:FLOAT,APCP_12:FLOAT,CICEP_12:FLOAT,DPT_12:FLOAT,GUST_12:FLOAT,RH_12:FLOAT,CFRZR_13:FLOAT,CRAIN_13:FLOAT,VIS_13:FLOAT,CSNOW_13:FLOAT,PRATE_13:FLOAT,TMP_13:FLOAT,UGRD_13:FLOAT,VGRD_13:FLOAT,PRES_13:FLOAT,APCP_13:FLOAT,CICEP_13:FLOAT,DPT_13:FLOAT,GUST_13:FLOAT,RH_13:FLOAT,CFRZR_14:FLOAT,CRAIN_14:FLOAT,VIS_14:FLOAT,CSNOW_14:FLOAT,PRATE_14:FLOAT,TMP_14:FLOAT,UGRD_14:FLOAT,VGRD_14:FLOAT,PRES_14:FLOAT,APCP_14:FLOAT,CICEP_14:FLOAT,DPT_14:FLOAT,GUST_14:FLOAT,RH_14:FLOAT,CFRZR_15:FLOAT,CRAIN_15:FLOAT,VIS_15:FLOAT,CSNOW_15:FLOAT,PRATE_15:FLOAT,TMP_15:FLOAT,UGRD_15:FLOAT,VGRD_15:FLOAT,PRES_15:FLOAT,APCP_15:FLOAT,CICEP_15:FLOAT,DPT_15:FLOAT,GUST_15:FLOAT,RH_15:FLOAT,CFRZR_16:FLOAT,CRAIN_16:FLOAT,VIS_16:FLOAT,CSNOW_16:FLOAT,PRATE_16:FLOAT,TMP_16:FLOAT,UGRD_16:FLOAT,VGRD_16:FLOAT,PRES_16:FLOAT,APCP_16:FLOAT,CICEP_16:FLOAT,DPT_16:FLOAT,GUST_16:FLOAT,RH_16:FLOAT,CFRZR_17:FLOAT,CRAIN_17:FLOAT,VIS_17:FLOAT,CSNOW_17:FLOAT,PRATE_17:FLOAT,TMP_17:FLOAT,UGRD_17:FLOAT,VGRD_17:FLOAT,PRES_17:FLOAT,APCP_17:FLOAT,CICEP_17:FLOAT,DPT_17:FLOAT,GUST_17:FLOAT,RH_17:FLOAT,CFRZR_18:FLOAT,CRAIN_18:FLOAT,VIS_18:FLOAT,CSNOW_18:FLOAT,PRATE_18:FLOAT,TMP_18:FLOAT,UGRD_18:FLOAT,VGRD_18:FLOAT,PRES_18:FLOAT,APCP_18:FLOAT,CICEP_18:FLOAT,DPT_18:FLOAT,GUST_18:FLOAT,RH_18:FLOAT,CFRZR_19:FLOAT,CRAIN_19:FLOAT,VIS_19:FLOAT,CSNOW_19:FLOAT,PRATE_19:FLOAT,TMP_19:FLOAT,UGRD_19:FLOAT,VGRD_19:FLOAT,PRES_19:FLOAT,APCP_19:FLOAT,CICEP_19:FLOAT,DPT_19:FLOAT,GUST_19:FLOAT,RH_19:FLOAT,CFRZR_20:FLOAT,CRAIN_20:FLOAT,VIS_20:FLOAT,CSNOW_20:FLOAT,PRATE_20:FLOAT,TMP_20:FLOAT,UGRD_20:FLOAT,VGRD_20:FLOAT,PRES_20:FLOAT,APCP_20:FLOAT,CICEP_20:FLOAT,DPT_20:FLOAT,GUST_20:FLOAT,RH_20:FLOAT,CFRZR_21:FLOAT,CRAIN_21:FLOAT,VIS_21:FLOAT,CSNOW_21:FLOAT,PRATE_21:FLOAT,TMP_21:FLOAT,UGRD_21:FLOAT,VGRD_21:FLOAT,PRES_21:FLOAT,APCP_21:FLOAT,CICEP_21:FLOAT,DPT_21:FLOAT,GUST_21:FLOAT,RH_21:FLOAT,CFRZR_22:FLOAT,CRAIN_22:FLOAT,VIS_22:FLOAT,CSNOW_22:FLOAT,PRATE_22:FLOAT,TMP_22:FLOAT,UGRD_22:FLOAT,VGRD_22:FLOAT,PRES_22:FLOAT,APCP_22:FLOAT,CICEP_22:FLOAT,DPT_22:FLOAT,GUST_22:FLOAT,RH_22:FLOAT,CFRZR_23:FLOAT,CRAIN_23:FLOAT,VIS_23:FLOAT,CSNOW_23:FLOAT,PRATE_23:FLOAT,TMP_23:FLOAT,UGRD_23:FLOAT,VGRD_23:FLOAT,PRES_23:FLOAT,APCP_23:FLOAT,CICEP_23:FLOAT,DPT_23:FLOAT,GUST_23:FLOAT,RH_23:FLOAT,CFRZR_24:FLOAT,CRAIN_24:FLOAT,VIS_24:FLOAT,CSNOW_24:FLOAT,PRATE_24:FLOAT,TMP_24:FLOAT,UGRD_24:FLOAT,VGRD_24:FLOAT,PRES_24:FLOAT,APCP_24:FLOAT,CICEP_24:FLOAT,DPT_24:FLOAT,GUST_24:FLOAT,RH_24:FLOAT,CFRZR_25:FLOAT,CRAIN_25:FLOAT,VIS_25:FLOAT,CSNOW_25:FLOAT,PRATE_25:FLOAT,TMP_25:FLOAT,UGRD_25:FLOAT,VGRD_25:FLOAT,PRES_25:FLOAT,APCP_25:FLOAT,CICEP_25:FLOAT,DPT_25:FLOAT,GUST_25:FLOAT,RH_25:FLOAT,CFRZR_26:FLOAT,CRAIN_26:FLOAT,VIS_26:FLOAT,CSNOW_26:FLOAT,PRATE_26:FLOAT,TMP_26:FLOAT,UGRD_26:FLOAT,VGRD_26:FLOAT,PRES_26:FLOAT,APCP_26:FLOAT,CICEP_26:FLOAT,DPT_26:FLOAT,GUST_26:FLOAT,RH_26:FLOAT,CFRZR_27:FLOAT,CRAIN_27:FLOAT,VIS_27:FLOAT,CSNOW_27:FLOAT,PRATE_27:FLOAT,TMP_27:FLOAT,UGRD_27:FLOAT,VGRD_27:FLOAT,PRES_27:FLOAT,APCP_27:FLOAT,CICEP_27:FLOAT,DPT_27:FLOAT,GUST_27:FLOAT,RH_27:FLOAT,CFRZR_28:FLOAT,CRAIN_28:FLOAT,VIS_28:FLOAT,CSNOW_28:FLOAT,PRATE_28:FLOAT,TMP_28:FLOAT,UGRD_28:FLOAT,VGRD_28:FLOAT,PRES_28:FLOAT,APCP_28:FLOAT,CICEP_28:FLOAT,DPT_28:FLOAT,GUST_28:FLOAT,RH_28:FLOAT,CFRZR_29:FLOAT,CRAIN_29:FLOAT,VIS_29:FLOAT,CSNOW_29:FLOAT,PRATE_29:FLOAT,TMP_29:FLOAT,UGRD_29:FLOAT,VGRD_29:FLOAT,PRES_29:FLOAT,APCP_29:FLOAT,CICEP_29:FLOAT,DPT_29:FLOAT,GUST_29:FLOAT,RH_29:FLOAT,CFRZR_30:FLOAT,CRAIN_30:FLOAT,VIS_30:FLOAT,CSNOW_30:FLOAT,PRATE_30:FLOAT,TMP_30:FLOAT,UGRD_30:FLOAT,VGRD_30:FLOAT,PRES_30:FLOAT,APCP_30:FLOAT,CICEP_30:FLOAT,DPT_30:FLOAT,GUST_30:FLOAT,RH_30:FLOAT,CFRZR_31:FLOAT,CRAIN_31:FLOAT,VIS_31:FLOAT,CSNOW_31:FLOAT,PRATE_31:FLOAT,TMP_31:FLOAT,UGRD_31:FLOAT,VGRD_31:FLOAT,PRES_31:FLOAT,APCP_31:FLOAT,CICEP_31:FLOAT,DPT_31:FLOAT,GUST_31:FLOAT,RH_31:FLOAT,CFRZR_32:FLOAT,CRAIN_32:FLOAT,VIS_32:FLOAT,CSNOW_32:FLOAT,PRATE_32:FLOAT,TMP_32:FLOAT,UGRD_32:FLOAT,VGRD_32:FLOAT,PRES_32:FLOAT,APCP_32:FLOAT,CICEP_32:FLOAT,DPT_32:FLOAT,GUST_32:FLOAT,RH_32:FLOAT,CFRZR_33:FLOAT,CRAIN_33:FLOAT,VIS_33:FLOAT,CSNOW_33:FLOAT,PRATE_33:FLOAT,TMP_33:FLOAT,UGRD_33:FLOAT,VGRD_33:FLOAT,PRES_33:FLOAT,APCP_33:FLOAT,CICEP_33:FLOAT,DPT_33:FLOAT,GUST_33:FLOAT,RH_33:FLOAT,CFRZR_34:FLOAT,CRAIN_34:FLOAT,VIS_34:FLOAT,CSNOW_34:FLOAT,PRATE_34:FLOAT,TMP_34:FLOAT,UGRD_34:FLOAT,VGRD_34:FLOAT,PRES_34:FLOAT,APCP_34:FLOAT,CICEP_34:FLOAT,DPT_34:FLOAT,GUST_34:FLOAT,RH_34:FLOAT,CFRZR_35:FLOAT,CRAIN_35:FLOAT,VIS_35:FLOAT,CSNOW_35:FLOAT,PRATE_35:FLOAT,TMP_35:FLOAT,UGRD_35:FLOAT,VGRD_35:FLOAT,PRES_35:FLOAT,APCP_35:FLOAT,CICEP_35:FLOAT,DPT_35:FLOAT,GUST_35:FLOAT,RH_35:FLOAT,CFRZR_36:FLOAT,CRAIN_36:FLOAT,VIS_36:FLOAT,CSNOW_36:FLOAT,PRATE_36:FLOAT,TMP_36:FLOAT,UGRD_36:FLOAT,VGRD_36:FLOAT,PRES_36:FLOAT,APCP_36:FLOAT,CICEP_36:FLOAT,DPT_36:FLOAT,GUST_36:FLOAT,RH_36:FLOAT

	

bq mk \
--table \
--range_partitioning=lonR,-1350,-600,1 \
hrrr2.run00z \
"lon:NUMERIC,lat:NUMERIC,CFRZR_0:FLOAT,CRAIN_0:FLOAT,VIS_0:FLOAT,CSNOW_0:FLOAT,PRATE_0:FLOAT,TMP_0:FLOAT,UGRD_0:FLOAT,VGRD_0:FLOAT,PRES_0:FLOAT,APCP_0:FLOAT,CICEP_0:FLOAT,DPT_0:FLOAT,GUST_0:FLOAT,RH_0:FLOAT,CFRZR_1:FLOAT,CRAIN_1:FLOAT,VIS_1:FLOAT,CSNOW_1:FLOAT,PRATE_1:FLOAT,TMP_1:FLOAT,UGRD_1:FLOAT,VGRD_1:FLOAT,PRES_1:FLOAT,APCP_1:FLOAT,CICEP_1:FLOAT,DPT_1:FLOAT,GUST_1:FLOAT,RH_1:FLOAT,CFRZR_2:FLOAT,CRAIN_2:FLOAT,VIS_2:FLOAT,CSNOW_2:FLOAT,PRATE_2:FLOAT,TMP_2:FLOAT,UGRD_2:FLOAT,VGRD_2:FLOAT,PRES_2:FLOAT,APCP_2:FLOAT,CICEP_2:FLOAT,DPT_2:FLOAT,GUST_2:FLOAT,RH_2:FLOAT,CFRZR_3:FLOAT,CRAIN_3:FLOAT,VIS_3:FLOAT,CSNOW_3:FLOAT,PRATE_3:FLOAT,TMP_3:FLOAT,UGRD_3:FLOAT,VGRD_3:FLOAT,PRES_3:FLOAT,APCP_3:FLOAT,CICEP_3:FLOAT,DPT_3:FLOAT,GUST_3:FLOAT,RH_3:FLOAT,CFRZR_4:FLOAT,CRAIN_4:FLOAT,VIS_4:FLOAT,CSNOW_4:FLOAT,PRATE_4:FLOAT,TMP_4:FLOAT,UGRD_4:FLOAT,VGRD_4:FLOAT,PRES_4:FLOAT,APCP_4:FLOAT,CICEP_4:FLOAT,DPT_4:FLOAT,GUST_4:FLOAT,RH_4:FLOAT,CFRZR_5:FLOAT,CRAIN_5:FLOAT,VIS_5:FLOAT,CSNOW_5:FLOAT,PRATE_5:FLOAT,TMP_5:FLOAT,UGRD_5:FLOAT,VGRD_5:FLOAT,PRES_5:FLOAT,APCP_5:FLOAT,CICEP_5:FLOAT,DPT_5:FLOAT,GUST_5:FLOAT,RH_5:FLOAT,CFRZR_6:FLOAT,CRAIN_6:FLOAT,VIS_6:FLOAT,CSNOW_6:FLOAT,PRATE_6:FLOAT,TMP_6:FLOAT,UGRD_6:FLOAT,VGRD_6:FLOAT,PRES_6:FLOAT,APCP_6:FLOAT,CICEP_6:FLOAT,DPT_6:FLOAT,GUST_6:FLOAT,RH_6:FLOAT,CFRZR_7:FLOAT,CRAIN_7:FLOAT,VIS_7:FLOAT,CSNOW_7:FLOAT,PRATE_7:FLOAT,TMP_7:FLOAT,UGRD_7:FLOAT,VGRD_7:FLOAT,PRES_7:FLOAT,APCP_7:FLOAT,CICEP_7:FLOAT,DPT_7:FLOAT,GUST_7:FLOAT,RH_7:FLOAT,CFRZR_8:FLOAT,CRAIN_8:FLOAT,VIS_8:FLOAT,CSNOW_8:FLOAT,PRATE_8:FLOAT,TMP_8:FLOAT,UGRD_8:FLOAT,VGRD_8:FLOAT,PRES_8:FLOAT,APCP_8:FLOAT,CICEP_8:FLOAT,DPT_8:FLOAT,GUST_8:FLOAT,RH_8:FLOAT,CFRZR_9:FLOAT,CRAIN_9:FLOAT,VIS_9:FLOAT,CSNOW_9:FLOAT,PRATE_9:FLOAT,TMP_9:FLOAT,UGRD_9:FLOAT,VGRD_9:FLOAT,PRES_9:FLOAT,APCP_9:FLOAT,CICEP_9:FLOAT,DPT_9:FLOAT,GUST_9:FLOAT,RH_9:FLOAT,CFRZR_10:FLOAT,CRAIN_10:FLOAT,VIS_10:FLOAT,CSNOW_10:FLOAT,PRATE_10:FLOAT,TMP_10:FLOAT,UGRD_10:FLOAT,VGRD_10:FLOAT,PRES_10:FLOAT,APCP_10:FLOAT,CICEP_10:FLOAT,DPT_10:FLOAT,GUST_10:FLOAT,RH_10:FLOAT,CFRZR_11:FLOAT,CRAIN_11:FLOAT,VIS_11:FLOAT,CSNOW_11:FLOAT,PRATE_11:FLOAT,TMP_11:FLOAT,UGRD_11:FLOAT,VGRD_11:FLOAT,PRES_11:FLOAT,APCP_11:FLOAT,CICEP_11:FLOAT,DPT_11:FLOAT,GUST_11:FLOAT,RH_11:FLOAT,CFRZR_12:FLOAT,CRAIN_12:FLOAT,VIS_12:FLOAT,CSNOW_12:FLOAT,PRATE_12:FLOAT,TMP_12:FLOAT,UGRD_12:FLOAT,VGRD_12:FLOAT,PRES_12:FLOAT,APCP_12:FLOAT,CICEP_12:FLOAT,DPT_12:FLOAT,GUST_12:FLOAT,RH_12:FLOAT,CFRZR_13:FLOAT,CRAIN_13:FLOAT,VIS_13:FLOAT,CSNOW_13:FLOAT,PRATE_13:FLOAT,TMP_13:FLOAT,UGRD_13:FLOAT,VGRD_13:FLOAT,PRES_13:FLOAT,APCP_13:FLOAT,CICEP_13:FLOAT,DPT_13:FLOAT,GUST_13:FLOAT,RH_13:FLOAT,CFRZR_14:FLOAT,CRAIN_14:FLOAT,VIS_14:FLOAT,CSNOW_14:FLOAT,PRATE_14:FLOAT,TMP_14:FLOAT,UGRD_14:FLOAT,VGRD_14:FLOAT,PRES_14:FLOAT,APCP_14:FLOAT,CICEP_14:FLOAT,DPT_14:FLOAT,GUST_14:FLOAT,RH_14:FLOAT,CFRZR_15:FLOAT,CRAIN_15:FLOAT,VIS_15:FLOAT,CSNOW_15:FLOAT,PRATE_15:FLOAT,TMP_15:FLOAT,UGRD_15:FLOAT,VGRD_15:FLOAT,PRES_15:FLOAT,APCP_15:FLOAT,CICEP_15:FLOAT,DPT_15:FLOAT,GUST_15:FLOAT,RH_15:FLOAT,CFRZR_16:FLOAT,CRAIN_16:FLOAT,VIS_16:FLOAT,CSNOW_16:FLOAT,PRATE_16:FLOAT,TMP_16:FLOAT,UGRD_16:FLOAT,VGRD_16:FLOAT,PRES_16:FLOAT,APCP_16:FLOAT,CICEP_16:FLOAT,DPT_16:FLOAT,GUST_16:FLOAT,RH_16:FLOAT,CFRZR_17:FLOAT,CRAIN_17:FLOAT,VIS_17:FLOAT,CSNOW_17:FLOAT,PRATE_17:FLOAT,TMP_17:FLOAT,UGRD_17:FLOAT,VGRD_17:FLOAT,PRES_17:FLOAT,APCP_17:FLOAT,CICEP_17:FLOAT,DPT_17:FLOAT,GUST_17:FLOAT,RH_17:FLOAT,CFRZR_18:FLOAT,CRAIN_18:FLOAT,VIS_18:FLOAT,CSNOW_18:FLOAT,PRATE_18:FLOAT,TMP_18:FLOAT,UGRD_18:FLOAT,VGRD_18:FLOAT,PRES_18:FLOAT,APCP_18:FLOAT,CICEP_18:FLOAT,DPT_18:FLOAT,GUST_18:FLOAT,RH_18:FLOAT,CFRZR_19:FLOAT,CRAIN_19:FLOAT,VIS_19:FLOAT,CSNOW_19:FLOAT,PRATE_19:FLOAT,TMP_19:FLOAT,UGRD_19:FLOAT,VGRD_19:FLOAT,PRES_19:FLOAT,APCP_19:FLOAT,CICEP_19:FLOAT,DPT_19:FLOAT,GUST_19:FLOAT,RH_19:FLOAT,CFRZR_20:FLOAT,CRAIN_20:FLOAT,VIS_20:FLOAT,CSNOW_20:FLOAT,PRATE_20:FLOAT,TMP_20:FLOAT,UGRD_20:FLOAT,VGRD_20:FLOAT,PRES_20:FLOAT,APCP_20:FLOAT,CICEP_20:FLOAT,DPT_20:FLOAT,GUST_20:FLOAT,RH_20:FLOAT,CFRZR_21:FLOAT,CRAIN_21:FLOAT,VIS_21:FLOAT,CSNOW_21:FLOAT,PRATE_21:FLOAT,TMP_21:FLOAT,UGRD_21:FLOAT,VGRD_21:FLOAT,PRES_21:FLOAT,APCP_21:FLOAT,CICEP_21:FLOAT,DPT_21:FLOAT,GUST_21:FLOAT,RH_21:FLOAT,CFRZR_22:FLOAT,CRAIN_22:FLOAT,VIS_22:FLOAT,CSNOW_22:FLOAT,PRATE_22:FLOAT,TMP_22:FLOAT,UGRD_22:FLOAT,VGRD_22:FLOAT,PRES_22:FLOAT,APCP_22:FLOAT,CICEP_22:FLOAT,DPT_22:FLOAT,GUST_22:FLOAT,RH_22:FLOAT,CFRZR_23:FLOAT,CRAIN_23:FLOAT,VIS_23:FLOAT,CSNOW_23:FLOAT,PRATE_23:FLOAT,TMP_23:FLOAT,UGRD_23:FLOAT,VGRD_23:FLOAT,PRES_23:FLOAT,APCP_23:FLOAT,CICEP_23:FLOAT,DPT_23:FLOAT,GUST_23:FLOAT,RH_23:FLOAT,CFRZR_24:FLOAT,CRAIN_24:FLOAT,VIS_24:FLOAT,CSNOW_24:FLOAT,PRATE_24:FLOAT,TMP_24:FLOAT,UGRD_24:FLOAT,VGRD_24:FLOAT,PRES_24:FLOAT,APCP_24:FLOAT,CICEP_24:FLOAT,DPT_24:FLOAT,GUST_24:FLOAT,RH_24:FLOAT,CFRZR_25:FLOAT,CRAIN_25:FLOAT,VIS_25:FLOAT,CSNOW_25:FLOAT,PRATE_25:FLOAT,TMP_25:FLOAT,UGRD_25:FLOAT,VGRD_25:FLOAT,PRES_25:FLOAT,APCP_25:FLOAT,CICEP_25:FLOAT,DPT_25:FLOAT,GUST_25:FLOAT,RH_25:FLOAT,CFRZR_26:FLOAT,CRAIN_26:FLOAT,VIS_26:FLOAT,CSNOW_26:FLOAT,PRATE_26:FLOAT,TMP_26:FLOAT,UGRD_26:FLOAT,VGRD_26:FLOAT,PRES_26:FLOAT,APCP_26:FLOAT,CICEP_26:FLOAT,DPT_26:FLOAT,GUST_26:FLOAT,RH_26:FLOAT,CFRZR_27:FLOAT,CRAIN_27:FLOAT,VIS_27:FLOAT,CSNOW_27:FLOAT,PRATE_27:FLOAT,TMP_27:FLOAT,UGRD_27:FLOAT,VGRD_27:FLOAT,PRES_27:FLOAT,APCP_27:FLOAT,CICEP_27:FLOAT,DPT_27:FLOAT,GUST_27:FLOAT,RH_27:FLOAT,CFRZR_28:FLOAT,CRAIN_28:FLOAT,VIS_28:FLOAT,CSNOW_28:FLOAT,PRATE_28:FLOAT,TMP_28:FLOAT,UGRD_28:FLOAT,VGRD_28:FLOAT,PRES_28:FLOAT,APCP_28:FLOAT,CICEP_28:FLOAT,DPT_28:FLOAT,GUST_28:FLOAT,RH_28:FLOAT,CFRZR_29:FLOAT,CRAIN_29:FLOAT,VIS_29:FLOAT,CSNOW_29:FLOAT,PRATE_29:FLOAT,TMP_29:FLOAT,UGRD_29:FLOAT,VGRD_29:FLOAT,PRES_29:FLOAT,APCP_29:FLOAT,CICEP_29:FLOAT,DPT_29:FLOAT,GUST_29:FLOAT,RH_29:FLOAT,CFRZR_30:FLOAT,CRAIN_30:FLOAT,VIS_30:FLOAT,CSNOW_30:FLOAT,PRATE_30:FLOAT,TMP_30:FLOAT,UGRD_30:FLOAT,VGRD_30:FLOAT,PRES_30:FLOAT,APCP_30:FLOAT,CICEP_30:FLOAT,DPT_30:FLOAT,GUST_30:FLOAT,RH_30:FLOAT,CFRZR_31:FLOAT,CRAIN_31:FLOAT,VIS_31:FLOAT,CSNOW_31:FLOAT,PRATE_31:FLOAT,TMP_31:FLOAT,UGRD_31:FLOAT,VGRD_31:FLOAT,PRES_31:FLOAT,APCP_31:FLOAT,CICEP_31:FLOAT,DPT_31:FLOAT,GUST_31:FLOAT,RH_31:FLOAT,CFRZR_32:FLOAT,CRAIN_32:FLOAT,VIS_32:FLOAT,CSNOW_32:FLOAT,PRATE_32:FLOAT,TMP_32:FLOAT,UGRD_32:FLOAT,VGRD_32:FLOAT,PRES_32:FLOAT,APCP_32:FLOAT,CICEP_32:FLOAT,DPT_32:FLOAT,GUST_32:FLOAT,RH_32:FLOAT,CFRZR_33:FLOAT,CRAIN_33:FLOAT,VIS_33:FLOAT,CSNOW_33:FLOAT,PRATE_33:FLOAT,TMP_33:FLOAT,UGRD_33:FLOAT,VGRD_33:FLOAT,PRES_33:FLOAT,APCP_33:FLOAT,CICEP_33:FLOAT,DPT_33:FLOAT,GUST_33:FLOAT,RH_33:FLOAT,CFRZR_34:FLOAT,CRAIN_34:FLOAT,VIS_34:FLOAT,CSNOW_34:FLOAT,PRATE_34:FLOAT,TMP_34:FLOAT,UGRD_34:FLOAT,VGRD_34:FLOAT,PRES_34:FLOAT,APCP_34:FLOAT,CICEP_34:FLOAT,DPT_34:FLOAT,GUST_34:FLOAT,RH_34:FLOAT,CFRZR_35:FLOAT,CRAIN_35:FLOAT,VIS_35:FLOAT,CSNOW_35:FLOAT,PRATE_35:FLOAT,TMP_35:FLOAT,UGRD_35:FLOAT,VGRD_35:FLOAT,PRES_35:FLOAT,APCP_35:FLOAT,CICEP_35:FLOAT,DPT_35:FLOAT,GUST_35:FLOAT,RH_35:FLOAT,CFRZR_36:FLOAT,CRAIN_36:FLOAT,VIS_36:FLOAT,CSNOW_36:FLOAT,PRATE_36:FLOAT,TMP_36:FLOAT,UGRD_36:FLOAT,VGRD_36:FLOAT,PRES_36:FLOAT,APCP_36:FLOAT,CICEP_36:FLOAT,DPT_36:FLOAT,GUST_36:FLOAT,RH_36:FLOAT,pt:GEOGRAPHY,lonR:integer"



bq query --destination_table brightground:hrrr.run00z --append_table --nouse_legacy_sql '
SELECT
   *,
  ST_GeogPoint(lon, lat) AS pt,
  CAST(ROUND(lon*10) AS INT64) AS lonR,
FROM
 hrrr.dataIN'
